(this["webpackJsonpdrom-test"]=this["webpackJsonpdrom-test"]||[]).push([[0],{48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(19),i=n.n(c),s=n(9),o=n(5),l=n(18),u=n.n(l),d=n(25),h="GET_CITIES_REQUEST",j="GET_DATES_REQUEST",p="SET_LOADING";var b={cityOptions:[],dateOptions:[],isFetching:!1};var O=n(30),f="ADD_ITEM",v="SET_SUCCESS",y="DEL_ITEM";var x={orders:[],isSuccess:!1};var m=Object(s.c)({cities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(o.a)(Object(o.a)({},e),{},{isFetching:!0});case h:return Object(o.a)(Object(o.a)({},e),{},{cityOptions:t.payload,isFetching:!1});case j:return Object(o.a)(Object(o.a)({},e),{},{dateOptions:t.payload,isFetching:!1});default:return e}},orders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:var n=[].concat(Object(O.a)(e.orders),[t.payload]);return Object(o.a)(Object(o.a)({},e),{},{orders:n});case y:var r=Object(O.a)(e.orders);return r.splice(t.payload,1),Object(o.a)(Object(o.a)({},e),{},{orders:r});case v:return Object(o.a)(Object(o.a)({},e),{},{isSuccess:t.payload});default:return e}}}),g=n(33),V=n(29),C=n(34),k={key:"store",storage:n.n(C).a},E=Object(V.a)(k,m),_=n(15),S=n.p+"static/media/logo.1e4921bc.svg",N=(n(48),n(35)),w=n(3),T=n(10),A=n(11),I=n(13),B=n(12),D=n(73),F=n(21),M=n.n(F),H=(n(49),n(50),n(1)),L=function(e){var t=e.value,n=e.placeholder,r=e.onChange,a=e.onBlur,c=e.error,i=e.type;return Object(H.jsxs)("div",{className:"text-field",children:[Object(H.jsx)("input",{value:t,type:"text",placeholder:n,onChange:r,onBlur:function(){return a(i)}}),c&&Object(H.jsx)("div",{className:"error",children:c})]})},P=n(16),R=(n(52),function(e){Object(I.a)(n,e);var t=Object(B.a)(n);function n(){return Object(T.a)(this,n),t.apply(this,arguments)}return Object(A.a)(n,[{key:"setValue",value:function(e){this.props.onChange(e)}},{key:"render",value:function(){var e=this.props.renderValue(this.props.value);return Object(H.jsx)("div",{onClick:this.setValue.bind(this,this.props.value),children:e})}}]),n}(a.a.Component)),$=function(e){Object(I.a)(n,e);var t=Object(B.a)(n);function n(e){var r;return Object(T.a)(this,n),(r=t.call(this,e)).state={isOpen:!1},r.handleToggleClick=r.handleToggleClick.bind(Object(P.a)(r)),r.onClickOutsideHandler=r.onClickOutsideHandler.bind(Object(P.a)(r)),r.toggleContainer=a.a.createRef(),r.buttonContainer=a.a.createRef(),r.setValue=r.setValue.bind(Object(P.a)(r)),r}return Object(A.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.onClickOutsideHandler)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideHandler)}},{key:"onClickOutsideHandler",value:function(e){this.state.isOpen&&!this.toggleContainer.current.contains(e.target)&&(this.setState({isOpen:!1}),this.props.onBlur(this.props.type))}},{key:"changeToggle",value:function(){this.setState((function(e){return{isOpen:!e.isOpen}})),!this.state.isOpen&&this.buttonContainer.current.focus()}},{key:"handleToggleClick",value:function(){this.props.options.length&&this.changeToggle()}},{key:"setValue",value:function(e){this.props.onChange(e),this.changeToggle()}},{key:"render",value:function(){var e=this,t=this.props,n=t.error,r=t.renderValue,a=t.value,c=t.placeholder,i=this.state.isOpen,s=this.props.options||[],o=r(a),l=s.map((function(t){return Object(H.jsx)(R,{renderValue:r,onChange:e.setValue,value:t},r(t))}));return Object(H.jsxs)("div",{children:[Object(H.jsxs)("div",{className:"select",ref:this.toggleContainer,children:[Object(H.jsx)("button",{ref:this.buttonContainer,onClick:this.handleToggleClick,className:i?"focus":"",children:o?Object(H.jsx)("span",{className:"select__value",children:o}):Object(H.jsx)("span",{className:"select__placeholder",children:c})}),Object(H.jsx)("svg",{width:"10",height:"6",viewBox:"0 0 10 6",children:Object(H.jsx)("path",{d:"M1.429.253a.819.819 0 0 0-1.184 0 .883.883 0 0 0 0 1.22l4.142 4.274A.821.821 0 0 0 5 6a.821.821 0 0 0 .612-.253l4.143-4.273a.883.883 0 0 0 0-1.221.819.819 0 0 0-1.184 0L5 3.937 1.429.253z",fill:"currentColor"})}),i&&Object(H.jsxs)("div",{className:"select__dropdown",children:[" ",l," "]})]}),n&&Object(H.jsx)("div",{className:"error",children:n})]})}}]),n}(a.a.Component),U=(n(53),function(e){var t,n,r=e.value,a=e.options,c=e.onBlur,i=e.onChange,s=e.error,o=e.type,l=a&&a[0]||{name:"\u0412\u043b\u0430\u0434\u0438\u0432\u043e\u0441\u0442\u043e\u043a"},u="";return r&&(t=r.address,n=(n=r.phones.map((function(e){return Object(H.jsx)("a",{href:"tel:"+e,children:e},e)}))).length&&n.reduce((function(e,t){return[e,", ",t]}))||"",u=r.price),Object(H.jsxs)("div",{className:"city-info",children:[Object(H.jsx)($,{type:o,value:r,placeholder:l&&l.name,options:a,onChange:i,onBlur:c,renderValue:function(e){return e&&e.name},error:s}),Object(H.jsxs)("div",{className:"city-info__sub",children:[t&&Object(H.jsxs)("p",{children:[t," "]}),n&&Object(H.jsx)("p",{children:n}),u&&Object(H.jsxs)("p",{children:["\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0443\u0441\u043b\u0443\u0433\u0438 ",u," \u20bd"]})]})]})}),q=(n(54),function(){return Object(H.jsxs)("div",{className:"spinner",children:[Object(H.jsx)("div",{className:"container",children:Object(H.jsx)("div",{className:"loader"})}),Object(H.jsx)("div",{className:"shims"})]})}),G=(n(55),function(e){var t=e.title,n=e.onClick,r=e.disabled;return Object(H.jsx)("button",{className:"button",disabled:r,onClick:n,children:t})}),z=function(e){Object(I.a)(n,e);var t=Object(B.a)(n);function n(){var e;Object(T.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={cityValue:"",dayValue:"",dayError:null,hoursValue:"",hoursError:null,phoneValue:"",phoneError:null,fioValue:"",fioError:null},e.placeholder={name:"\u0412\u043b\u0430\u0434\u0438\u0432\u043e\u0441\u0442\u043e\u043a"},e.setCity=function(t){e.setState({cityValue:t,dayValue:null,hoursValue:null}),e.props.getCityDateAction(t.id)},e.setDay=function(t){e.setState({dayValue:t,dayError:""})},e.setHours=function(t){e.setState({hoursValue:t,dayError:""})},e.validateName=function(e){return/[A-Za-z]{3,}|[\u0410-\u042f,\u0430-\u044f\u0451]{3,}/.test(e)?"":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0438\u043c\u044f"},e.validatePhone=function(e){return/^(\+7|7|8){1}?[\s\-]?\(?[489][0-9]{2}\)?[\s\-]?[0-9]{3}[\s\-]?[0-9]{2}[\s\-]?[0-9]{2}$/.test(e)?"":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d, \u043d\u0430\u0447\u0435 \u043d\u0430\u0448\u0438 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u044b \u043d\u0435 \u0441\u043c\u043e\u0433\u0443\u0442 \u0432\u044f\u0437\u0430\u0442\u044c\u0441\u044f \u0441 \u0432\u0430\u043c\u0438"},e.validateIsRequired=function(e){return e?"":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u044f"},e.onBlur=function(t){var n=e.state,r=n.fioValue,a=n.phoneValue,c=n.dayValue,i=n.hoursValue;switch(t){case"fio":var s=e.validateName(r);e.setState({fioError:s});break;case"phone":var o=e.validatePhone(a);e.setState({phoneError:o});break;case"day":var l=e.validateIsRequired(c);e.setState({dayError:l});break;case"hours":var u=e.validateIsRequired(i);e.setState({dayError:u})}},e.onFioChange=function(t){return e.setState({fioValue:t.target.value,fioError:e.validateName(t.target.value)})},e.onPhoneChange=function(t){var n=t.target.value.replace(/^(\+7|7|8)(\d{3})(\d{3})(\d{2})(\d{2})/,"$1 ($2) $3-$4-$5");e.setState({phoneValue:n,phoneError:e.validatePhone(n)})},e.isValidForm=function(){var t=e.state,n=t.phoneError,r=t.fioError,a=t.dayError,c=t.cityValue,i=t.dayValue,s=t.hoursValue,o=t.phoneValue,l=t.fioValue;return!(n||a||r)&&!(null===n||null===a||null===r)&&!!(c&&i&&s&&o&&l)},e.onSumbit=function(){var t=e.state,n=t.cityValue,r=t.dayValue,a=t.hoursValue,c=t.phoneValue,i=t.fioValue;e.isValidForm()&&(e.props.addItemAction({cityValue:n,dayValue:r,hoursValue:a,phoneValue:c,fioValue:i}),e.setState({fioValue:"",phoneValue:"",dayValue:"",hoursValue:""}))},e}return Object(A.a)(n,[{key:"componentDidMount",value:function(){this.props.getCitiesAction()}},{key:"componentDidUpdate",value:function(){var e=this.props.cities.cityOptions[0];!this.state.cityValue&&e&&this.setCity(e)}},{key:"render",value:function(){var e=this.state,t=e.phoneError,n=e.fioError,r=e.dayError,a=e.cityValue,c=e.dayValue,i=e.hoursValue,s=e.phoneValue,o=e.fioValue,l=this.props.cities,u=l.cityOptions,d=l.dateOptions,h=l.isFetching,j=this.state.dayValue&&this.state.dayValue.hours||[],p=this.isValidForm();return Object(H.jsxs)("div",{className:"form",children:[Object(H.jsx)("div",{children:Object(H.jsx)(U,{type:"city",value:a,options:u,onChange:this.setCity})}),Object(H.jsxs)("div",{className:"form__row",children:[Object(H.jsx)($,{type:"day",placeholder:"\u0414\u0430\u0442\u0430",onBlur:this.onBlur,value:c,options:d,onChange:this.setDay,renderValue:function(e){return e&&Object(D.a)(new Date(e.date),"EEEE, d MMMM",{locale:M.a})},error:r}),Object(H.jsx)($,{type:"hours",placeholder:"\u0412\u0440\u0435\u043c\u044f",onBlur:this.onBlur,value:i,options:j,onChange:this.setHours,renderValue:function(e){return e&&"".concat(e.begin,"-").concat(e.end)}})]}),Object(H.jsx)("div",{children:Object(H.jsx)(L,{type:"phone",value:s,placeholder:"+7 (___) ___-__-__",onChange:this.onPhoneChange,onBlur:this.onBlur,error:t})}),Object(H.jsx)("div",{children:Object(H.jsx)(L,{type:"fio",value:o,placeholder:"\u0412\u0430\u0448\u0435 \u0418\u043c\u044f",onChange:this.onFioChange,onBlur:this.onBlur,error:n})}),Object(H.jsx)("div",{className:"form__footer",children:Object(H.jsx)(G,{onClick:this.onSumbit,title:"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",disabled:!p})}),h&&Object(H.jsx)(q,{})]})}}]),n}(a.a.Component),J=Object(_.b)((function(e){return{cities:e.cities}}),(function(e){return{getCitiesAction:function(){return e(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:p}),e.next=4,fetch("https://www.mocky.io/v2/5b34c0d82f00007400376066?mocky-delay=700ms");case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a=r.cities,t({type:h,payload:a});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getCityDateAction:function(t){return e(function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){var r,a,c,i,s,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:p}),r="https://www.mocky.io/v2/".concat(e,"?mocky-delay=700ms"),t.next=4,fetch(r);case 4:return a=t.sent,t.next=7,a.json();case 7:c=t.sent,i=c.data,s=Object.keys(i),o=s.map((function(e){return{date:e,hours:Object.values(i[e]).filter((function(e){return!e.is_not_free}))}})).filter((function(e){return e.hours.length>0})),n({type:j,payload:o});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},addItemAction:function(t){return e(function(e){return function(t){t({type:v,payload:!0}),t({type:f,payload:e}),setTimeout((function(){t({type:v,payload:!1})}),3e3)}}(t))}}}))(z),Q=(n(69),function(e){Object(I.a)(n,e);var t=Object(B.a)(n);function n(){return Object(T.a)(this,n),t.apply(this,arguments)}return Object(A.a)(n,[{key:"del",value:function(e){this.props.deleteItem(e)}},{key:"render",value:function(){var e=this.props.value;return Object(H.jsxs)("tr",{children:[Object(H.jsx)("td",{children:e.cityValue.name}),Object(H.jsx)("td",{children:e.cityValue.address}),Object(H.jsx)("td",{children:Object(D.a)(new Date(e.dayValue.date),"EEEE, d MMMM",{locale:M.a})}),Object(H.jsx)("td",{children:"".concat(e.hoursValue.begin,"-").concat(e.hoursValue.end)}),Object(H.jsx)("td",{children:e.phoneValue}),Object(H.jsx)("td",{children:e.fioValue}),Object(H.jsx)("td",{children:Object(H.jsx)(G,{onClick:this.del.bind(this,this.props.index),title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})]})}}]),n}(a.a.Component)),W=function(e){var t=e.data,n=e.deleteItem,r=t.length&&t.map((function(e,t){return Object(H.jsx)(Q,{index:t,value:e,deleteItem:n},t)}))||Object(H.jsx)("tr",{children:Object(H.jsx)("td",{colSpan:"6",children:"\u041f\u0443\u0441\u0442\u043e"})});return Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{children:[Object(H.jsx)("th",{children:"\u0413\u043e\u0440\u043e\u0434"}),Object(H.jsx)("th",{children:"\u0410\u0434\u0440\u0435\u0441"}),Object(H.jsx)("th",{children:"\u0414\u0435\u043d\u044c"}),Object(H.jsx)("th",{children:"\u0412\u0440\u0435\u043c\u044f"}),Object(H.jsx)("th",{children:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"}),Object(H.jsx)("th",{children:"\u0418\u043c\u044f"})]})}),Object(H.jsx)("tbody",{children:r})]})};var Z=Object(_.b)((function(e){return{appointment:e.orders}}),(function(e){return{delItemAction:function(t){return e((n=t,function(e){e({type:y,payload:n})}));var n}}}))((function(e){var t=e.appointment,n=e.delItemAction,r=t.isSuccess,a=t.orders;return Object(H.jsx)(N.a,{children:Object(H.jsxs)("div",{className:"App",children:[Object(H.jsxs)("header",{className:"App-header",children:[Object(H.jsx)("img",{src:S,className:"App-logo",alt:"logo"}),Object(H.jsx)("h1",{children:"\u041e\u043d\u043b\u0430\u0439\u043d \u0437\u0430\u043f\u0438\u0441\u044c"})]}),Object(H.jsx)("div",{className:"App-body",children:Object(H.jsxs)(w.d,{children:[Object(H.jsx)(w.b,{path:"/orders",children:Object(H.jsx)(W,{deleteItem:n,data:a})}),Object(H.jsxs)(w.b,{exact:!0,path:"/",children:[r&&Object(H.jsx)("p",{children:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b"}),Object(H.jsx)(J,{})]}),Object(H.jsx)(w.b,{exact:!0,path:"*",children:Object(H.jsx)(w.a,{to:"/"})})]})}),Object(H.jsxs)("footer",{className:"App-footer",children:['\u041d\u0430\u0436\u0438\u043c\u0430\u044f "\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f", \u044f \u0432\u044b\u0440\u0430\u0436\u0430\u044e \u0441\u0432\u043e\u0451 \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u0435 \u0441 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u043c\u043e\u0438\u0445 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0441\u0442\u0432\u0438\u0438 \u0441 \u043f\u0440\u0438\u043d\u044f\u0442\u043e\u0439 ',Object(H.jsx)("a",{href:"http://memesmix.net/media/created/td09d5.jpg",children:"\u043f\u043e\u043b\u0438\u0442\u0438\u043a\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0434\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438"})," \u0438 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e ",Object(H.jsx)("a",{href:"http://memesmix.net/media/created/nbhcue.jpg",children:"\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0435 \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435"})]})]})})})),K=(n(71),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,74)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))}),X=function(){var e=Object(s.d)(E,Object(s.a)(g.a));return{store:e,persistor:Object(V.b)(e)}}().store;i.a.render(Object(H.jsx)(_.a,{store:X,children:Object(H.jsx)(Z,{})}),document.getElementById("root")),K()}},[[72,1,2]]]);
//# sourceMappingURL=main.aa28acfd.chunk.js.map